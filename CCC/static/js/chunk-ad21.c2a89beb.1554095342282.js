(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ad21"],{"42zc":function(e,t,r){"use strict";r.r(t);var o=r("gDS+"),l=r.n(o),a=r("lpuf"),n=r("VG0r"),i=r("WjBf"),s=r("Oncr"),c=r("V262"),u=r("IwTE"),d={name:"AddRequirePlan",components:{ProducePlan:r("ZzLA").a,MyRepository:u.a,MyCenter:i.a,MyEmp:s.a,MyDetail:c.a},data:function(){return{materialsSource:[{value:1,label:"库存"},{value:2,label:"生产"},{value:3,label:"采购"}],producePlanNumber:"",produceRepositoryId:"",handlePersonId:"",workCenterId:"",repositorycontrol:!1,stockControl:!1,producecontrol:!1,centercontrol:!1,control:!1,personalForm:{createPersonId:3,countryId:1,repositoryId:438,regionId:2},personalrules:{handlePersonId:[{required:!0,message:"请选择负责人",trigger:"focus"}],producePlanNumber:[{required:!0,validator:function(e,t,r){console.log(t),""===t?r(new Error("请输入密码")):r()},trigger:"focus"}],planSupplyDate:[{required:!0,message:"请选择计划供料日期",trigger:"change"}],produceRepositoryId:[{required:!0,message:"请选择仓库",trigger:"focus"}]},list2:[],validRules:{}}},methods:{getTypeName:function(e){return Object(n.o)(e.typeId).then(function(t){200===t.data.ret&&(e.productType=t.data.data.content.list[0].categoryName)}),e.productType},producechoose:function(){if(""===this.personalForm.produceRepositoryId||null===this.personalForm.produceRepositoryId||void 0===this.personalForm.produceRepositoryId)return this.$notify.error({title:"错误",message:"请先选择仓库",offset:100}),!1;this.producecontrol=!0},allinfo:function(e){var t=this;this.$refs.editable.clear(),this.producePlanNumber=e.title,this.personalForm.producePlanNumber=e.planNumber,Object(a.c)(this.personalForm.producePlanNumber,this.personalForm.produceRepositoryId).then(function(e){if(console.log(e),200===e.data.ret){var r=e.data.data.content;for(var o in r)""!==r[o].materialsSource&&void 0!==r[o].materialsSource&&null!==r[o].materialsSource||delete r[o];for(var l=r.filter(function(e){return void 0!==e||e}).map(function(e){return{id:e.id,productCode:e.productCode,productName:e.productName,typeId:e.typeId,unit:e.unit,requireQuantity:e.requireQuantity,planQuantity:e.planQuantity,materialsSource:e.materialsSource}}),a=0;a<l.length;a++)t.$refs.editable.insert(l[a])}})},workcenterchoose:function(){this.centercontrol=!0},center:function(e){console.log(e),this.workCenterId=e.workCenterName,this.personalForm.workCenterId=e.id},handlechooseStock:function(){this.stockControl=!0},stockName:function(e){this.handlePersonId=e.personName,this.personalForm.handlePersonId=e.id},handlechooseRep:function(){this.repositorycontrol=!0},repositoryname:function(e){console.log(e),this.produceRepositoryId=e.repositoryName,this.personalForm.produceRepositoryId=e.id},restAllForm:function(){this.personalForm={createPersonId:3,countryId:1,repositoryId:438,regionId:2},this.produceRepositoryId=null,this.handlePersonId=null,this.workCenterId=null,this.producePlanNumber=null},handlesave:function(){var e=this,t=this.$refs.editable.getRecords();if(0===t.length)return this.$notify.error({title:"错误",message:"明细表不能为空",offset:100}),!1;t.map(function(e){return e}).forEach(function(e){return null!==e.productCode&&""!==e.productCode&&void 0!==e.productCode||delete e.productCode,null!==e.productName&&""!==e.productName&&void 0!==e.productName||delete e.productName,null!==e.typeId&&""!==e.typeId&&void 0!==e.typeId||delete e.typeId,null!==e.unit&&""!==e.unit&&void 0!==e.unit||delete e.unit,null!==e.requireQuantity&&""!==e.requireQuantity&&void 0!==e.requireQuantity||delete e.requireQuantity,null!==e.planQuantity&&""!==e.planQuantity&&void 0!==e.planQuantity||delete e.planQuantity,null!==e.issueQuantity&&""!==e.issueQuantity&&void 0!==e.issueQuantity||delete e.issueQuantity,null!==e.productType&&""!==e.productType&&void 0!==e.productType||delete e.productType,e});var r=l()(t),o=this.personalForm;for(var n in o)""!==o[n]&&void 0!==o[n]&&null!==o[n]||delete o[n];var i=l()(o);this.$refs.personalForm.validate(function(t){if(!t)return e.$notify.error({title:"错误",message:"信息未填完整",offset:100}),!1;Object(a.a)(i,r,e.personalForm).then(function(t){console.log(t),200===t.data.ret?(e.$notify({title:"成功",message:"保存成功",type:"success",offset:100}),e.restAllForm(),e.$refs.editable.clear(),e.$refs.personalForm.clearValidate(),e.$refs.personalForm.resetFields()):e.$notify.error({title:"错误",message:t.data.msg,offset:100})})})},handlecancel:function(){this.$router.go(-1);this.$store.dispatch("delView",{path:"/RequirePlan/AddRequirePlan",name:"AddRequirePlan",fullPath:"/RequirePlan/AddRequirePlan",title:"AddRequirePlan"}).then(function(e){e.visitedViews})}}},p=(r("Zgwm"),r("KHd+")),m=Object(p.a)(d,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ERP-container"},[r("div",{staticClass:"app-container",staticStyle:{"padding-right":"0"}},[r("el-card",{staticClass:"box-card"},[r("h2",{ref:"geren",staticClass:"form-name"},[e._v("基本信息")]),e._v(" "),r("div",{staticClass:"container"},[r("el-form",{ref:"personalForm",staticClass:"demo-ruleForm",staticStyle:{"margin-left":"30px"},attrs:{model:e.personalForm,rules:e.personalrules,inline:!0,"status-icon":"","label-width":"110px"}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("RequirePlan.title")}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},model:{value:e.personalForm.title,callback:function(t){e.$set(e.personalForm,"title",t)},expression:"personalForm.title"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("RequirePlan.handlePersonId"),prop:"handlePersonId"}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},on:{focus:e.handlechooseStock},model:{value:e.handlePersonId,callback:function(t){e.handlePersonId=t},expression:"handlePersonId"}})],1),e._v(" "),r("my-emp",{attrs:{control:e.stockControl},on:{"update:control":function(t){e.stockControl=t},stockName:e.stockName}})],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("RequirePlan.deptId")}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},on:{focus:e.workcenterchoose},model:{value:e.workCenterId,callback:function(t){e.workCenterId=t},expression:"workCenterId"}})],1)],1),e._v(" "),r("my-center",{attrs:{control:e.centercontrol},on:{"update:control":function(t){e.centercontrol=t},center:e.center}}),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("RequirePlan.producePlanNumber"),prop:"producePlanNumber"}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{value:e.producePlanNumber,clearable:""},on:{focus:e.producechoose},model:{value:e.producePlanNumber,callback:function(t){e.producePlanNumber=t},expression:"producePlanNumber"}})],1),e._v(" "),r("produce-plan",{attrs:{procontrol:e.producecontrol},on:{"update:procontrol":function(t){e.producecontrol=t},allinfo:e.allinfo}})],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("RequirePlan.planSupplyDate"),prop:"planSupplyDate"}},[r("el-date-picker",{staticStyle:{"margin-left":"18px"},attrs:{type:"date",placeholder:"计划供料日期","value-format":"yyyy-MM-dd"},model:{value:e.personalForm.planSupplyDate,callback:function(t){e.$set(e.personalForm,"planSupplyDate",t)},expression:"personalForm.planSupplyDate"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("RequirePlan.produceRepositoryId"),prop:"produceRepositoryId"}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},on:{focus:e.handlechooseRep},model:{value:e.produceRepositoryId,callback:function(t){e.produceRepositoryId=t},expression:"produceRepositoryId"}})],1),e._v(" "),r("my-repository",{attrs:{repositorycontrol:e.repositorycontrol},on:{"update:repositorycontrol":function(t){e.repositorycontrol=t},repositoryname:e.repositoryname}})],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("RequirePlan.summary")}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},model:{value:e.personalForm.summary,callback:function(t){e.$set(e.personalForm,"summary",t)},expression:"personalForm.summary"}})],1)],1)],1)],1)],1)]),e._v(" "),r("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"15px"}},[r("h2",{ref:"fuzhu",staticClass:"form-name"},[e._v("物料需求计划明细")]),e._v(" "),r("div",{staticClass:"buttons",staticStyle:{"margin-top":"58px"}},[r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.$refs.editable.removeSelecteds()}}},[e._v("删除")])],1),e._v(" "),r("div",{staticClass:"container"},[r("el-editable",{ref:"editable",staticClass:"click-table1",staticStyle:{width:"100%"},attrs:{data:e.list2,"edit-config":{showIcon:!0,showStatus:!0},"edit-rules":e.validRules,stripe:"",border:"",size:"medium"},on:{"update:data":function(t){e.list2=t}}},[r("el-editable-column",{attrs:{type:"selection","min-width":"55",align:"center"}}),e._v(" "),r("el-editable-column",{attrs:{label:"序号","min-width":"55",align:"center",type:"index"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"productCode",align:"center",label:"物品编号","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"productName",align:"center",label:"物品名称","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"productType",align:"center",label:"规格","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[e._v(e._s(e.getTypeName(t.row)))])]}}])}),e._v(" "),r("el-editable-column",{attrs:{prop:"unit",align:"center",label:"单位","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"requireQuantity",align:"center",label:"毛需求数量","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"planQuantity",align:"center",label:"应计划数量","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElSelect",options:e.materialsSource,type:"visible"},prop:"materialsSource",align:"center",label:"物料来源","min-width":"150px"}})],1)],1)]),e._v(" "),r("div",{staticClass:"buttons",staticStyle:{"margin-top":"20px"}},[r("el-button",{staticStyle:{background:"#3696fd","border-color":"#3696fd",width:"98px"},attrs:{type:"primary"},on:{click:function(t){e.handlesave()}}},[e._v("保存")]),e._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.handlecancel()}}},[e._v("取消")])],1)],1)])},[],!1,null,"af825578",null);m.options.__file="AddRequirePlan.vue";t.default=m.exports},YHGK:function(e,t,r){},Zgwm:function(e,t,r){"use strict";var o=r("YHGK");r.n(o).a}}]);