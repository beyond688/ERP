(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7b4b"],{"30SY":function(e,t,r){},"7Qgk":function(e,t,r){"use strict";r.r(t);var n=r("gDS+"),o=r.n(n),l=r("rW1G"),a=r("moiu"),i=r("6HaC"),s=r("5zi4"),d=r("Vwvj"),c=r("celV"),u={name:"AddProducePlan",components:{MyCenter:s.a,MyEmp:d.a,MyDetail:c.a},data:function(){return{depts:[],handlePersonId:"",workCenterId:"",stockControl:!1,centercontrol:!1,control:!1,personalForm:{createPersonId:3,countryId:1,repositoryId:438,regionId:2},personalrules:{handlePersonId:[{required:!0,message:"请选择负责人",trigger:"focus"}]},list2:[],workCenterIds:[],validRules:{}}},created:function(){this.getdepts()},methods:{getdepts:function(){var e=this;Object(a.m)().then(function(t){200===t.data.ret&&(e.depts=t.data.data.content)})},choosedept:function(){var e=this;console.log(this.personalForm.produceDeptId),""!==this.personalForm.produceDeptId&&null!==this.personalForm.produceDeptId&&void 0!==this.personalForm.produceDeptId&&Object(i.o)(this.personalForm.produceDeptId).then(function(t){200===t.data.ret&&(e.workCenterIds=t.data.data.content.list.map(function(e){return{label:e.workCenterName,value:e.id}}))})},workcenterchoose:function(){this.centercontrol=!0},center:function(e){console.log(e),this.workCenterId=e.workCenterName,this.personalForm.workCenterId=e.id},handlechooseStock:function(){this.stockControl=!0},stockName:function(e){this.handlePersonId=e.personName,this.personalForm.handlePersonId=e.id},handleAddproduct:function(){this.control=!0},productdetail:function(e){console.log(e);for(var t=this.$refs.editable.getRecords(),r=0;r<e.length;r++){for(var n=0;n<t.length;n++)if(e[r].productCode===t[n].productCode)return this.$notify.error({title:"错误",message:"物品已添加",offset:100}),!1;this.$refs.editable.insert(e[r])}},restAllForm:function(){this.personalForm={createPersonId:3,countryId:1,repositoryId:438,regionId:2},this.handlePersonId=null,this.deptId=null},handlesave:function(){var e=this,t=this.$refs.editable.getRecords();if(0===t.length)return this.$notify.error({title:"错误",message:"明细表不能为空",offset:100}),!1;t.map(function(e){return e}).forEach(function(e){return null!==e.productCode&&""!==e.productCode&&void 0!==e.productCode||delete e.productCode,null!==e.productName&&""!==e.productName&&void 0!==e.productName||delete e.productName,null!==e.typeId&&""!==e.typeId&&void 0!==e.typeId||delete e.typeId,null!==e.unit&&""!==e.unit&&void 0!==e.unit||delete e.unit,null!==e.requireQuantity&&""!==e.requireQuantity&&void 0!==e.requireQuantity||delete e.requireQuantity,null!==e.planQuantity&&""!==e.planQuantity&&void 0!==e.planQuantity||delete e.planQuantity,e});var r=o()(t),n=this.personalForm;for(var a in n)""!==n[a]&&void 0!==n[a]&&null!==n[a]||delete n[a];var i=o()(n);this.$refs.personalForm.validate(function(t){if(!t)return e.$notify.error({title:"错误",message:"信息未填完整",offset:100}),!1;Object(l.a)(i,r,e.personalForm).then(function(t){console.log(t),200===t.data.ret?(e.$notify({title:"成功",message:"保存成功",type:"success",offset:100}),e.restAllForm(),e.$refs.editable.clear(),e.$refs.personalForm.clearValidate(),e.$refs.personalForm.resetFields()):e.$notify.error({title:"错误",message:t.data.msg,offset:100})})})},handlecancel:function(){this.$router.go(-1);this.$store.dispatch("delView",{path:"/ProducePlan/AddProducePlan",name:"AddProducePlan",fullPath:"/ProducePlan/AddProducePlan",title:"AddProducePlan"}).then(function(e){e.visitedViews})}}},p=(r("z5lx"),r("KHd+")),m=Object(p.a)(u,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ERP-container"},[r("div",{staticClass:"app-container",staticStyle:{"padding-right":"0"}},[r("el-card",{staticClass:"box-card"},[r("h2",{ref:"geren",staticClass:"form-name"},[e._v("基本信息")]),e._v(" "),r("div",{staticClass:"container"},[r("el-form",{ref:"personalForm",staticClass:"demo-ruleForm",staticStyle:{"margin-left":"30px"},attrs:{model:e.personalForm,rules:e.personalrules,inline:!0,"status-icon":"","label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("ProducePlan.title")}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},model:{value:e.personalForm.title,callback:function(t){e.$set(e.personalForm,"title",t)},expression:"personalForm.title"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("ProducePlan.handlePersonId"),prop:"handlePersonId"}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},on:{focus:e.handlechooseStock},model:{value:e.handlePersonId,callback:function(t){e.handlePersonId=t},expression:"handlePersonId"}})],1),e._v(" "),r("my-emp",{attrs:{control:e.stockControl},on:{"update:control":function(t){e.stockControl=t},stockName:e.stockName}})],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("ProducePlan.produceDeptId"),prop:"produceDeptId"}},[r("el-select",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},on:{change:e.choosedept},model:{value:e.personalForm.produceDeptId,callback:function(t){e.$set(e.personalForm,"produceDeptId",t)},expression:"personalForm.produceDeptId"}},e._l(e.depts,function(e,t){return r("el-option",{key:t,attrs:{value:e.id,label:e.deptName}})}))],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:e.$t("ProducePlan.summary")}},[r("el-input",{staticStyle:{"margin-left":"18px"},attrs:{clearable:""},model:{value:e.personalForm.summary,callback:function(t){e.$set(e.personalForm,"summary",t)},expression:"personalForm.summary"}})],1)],1)],1)],1)],1)]),e._v(" "),r("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"15px"}},[r("h2",{ref:"fuzhu",staticClass:"form-name"},[e._v("主生产计划明细")]),e._v(" "),r("div",{staticClass:"buttons",staticStyle:{"margin-top":"58px"}},[r("el-button",{staticStyle:{background:"#3696fd","border-color":"#3696fd"},attrs:{type:"success"},on:{click:e.handleAddproduct}},[e._v("添加商品")]),e._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.$refs.editable.removeSelecteds()}}},[e._v("删除")])],1),e._v(" "),r("my-detail",{attrs:{control:e.control},on:{"update:control":function(t){e.control=t},product:e.productdetail}}),e._v(" "),r("div",{staticClass:"container"},[r("el-editable",{ref:"editable",staticClass:"click-table1",staticStyle:{width:"100%"},attrs:{data:e.list2,"edit-config":{showIcon:!0,showStatus:!0},"edit-rules":e.validRules,stripe:"",border:"",size:"medium"},on:{"update:data":function(t){e.list2=t}}},[r("el-editable-column",{attrs:{type:"selection","min-width":"55",align:"center"}}),e._v(" "),r("el-editable-column",{attrs:{label:"序号","min-width":"55",align:"center",type:"index"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"productCode",align:"center",label:"物品编号","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"productName",align:"center",label:"物品名称","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"typeIdname",align:"center",label:"规格","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{prop:"unit",align:"center",label:"单位","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElSelect",options:e.workCenterIds,type:"visible"},prop:"workCenterId",align:"center",label:"工作中心","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElInputNumber",attrs:{min:0},type:"visible"},prop:"requireQuantity",align:"center",label:"需求数量","min-width":"150px"}}),e._v(" "),r("el-editable-column",{attrs:{"edit-render":{name:"ElInputNumber",attrs:{min:0},type:"visible"},prop:"planQuantity",align:"center",label:"计划生产数量","min-width":"150px"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"buttons",staticStyle:{"margin-top":"20px"}},[r("el-button",{staticStyle:{background:"#3696fd","border-color":"#3696fd",width:"98px"},attrs:{type:"primary"},on:{click:function(t){e.handlesave()}}},[e._v("保存")]),e._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.handlecancel()}}},[e._v("取消")])],1)],1)])},[],!1,null,"1dafa2e2",null);m.options.__file="AddProducePlan.vue";t.default=m.exports},z5lx:function(e,t,r){"use strict";var n=r("30SY");r.n(n).a}}]);